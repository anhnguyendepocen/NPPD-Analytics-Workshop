---
title: "Introduction to R"
output:
  html_document:
    code_folding: show
    fig_caption: yes
    theme: cerulean
    toc: true
    self_contained: true
  word_document:
    reference_docx: U:\Templates\Rmarkdown Word\word_template.docx
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Who has worked with software designed to store, summarize, visualize, or analyze data? 

- Spreadsheets: Microsoft Excel, Google Sheets, etc.
- Data Analysis and Statistical programs: SAS, SPSS, Minitab
- Programming languages: Python, C, C++, Fortran, Java
- Database software: Microsoft Access, SAP, SQL databases

`R` is statistical software which can read data, manipulate data, summarize data, fit statistical models, create quality plots, and more. It is used by companies like Google, Twitter, and Microsoft, as well as in government agencies and at national labs. 

# Setting Up

This guide will help you set up R and RStudio on your machine. It is included for reference. 

## Installing R:

On Windows or OS X:

- Go to http://www.r-project.org/
- Click the CRAN link on the left, and pick a download site (0-Cloud is a good choice)
- Choose link based on your OS
- On Windows, choose the "base" subdirectory to install R.
- On OS X, choose the .pkg file to install R.

## Installing RStudio:

- Browse to https://www.rstudio.com/
- Mouse over Products and click RStudio
- Choose RStudio Desktop
- Click Download RStudio Desktop
- Choose the installer appropriate for your platform

# Example: Tips data

## Goals

- Explore a real dataset using R
- Get the "flavor" of R for data management and exploration
- Don't focus on the code - it will be explained later and in much more detail

## Tips Dataset

A server recorded the tips they received over about 10 weeks, including several variables:

  - Amount they were tipped
  - Cost of the total bill
  - Characteristics about the party (# people, gender, etc.)

Primary Question: How do these variable influence the amount being tipped?

Follow along using [Tips-Example.R](code/Tips-Example.R)

## First look: Reading in the data

Lets use R to look at the top few rows of the tips data set. First, we load tip using `read.csv`:

```{r}
tips <- read.csv("http://srvanderplas.github.com/NPPD-Analytics-Workshop/01.Introduction/data/tips.csv")
```

Now, we use the `head` function to look at the first 6 rows of the data:

```{r}
head(tips)
```

How big is this data set and what types of variables are in each column?

```{r}
str(tips)
```

We can get a summary of the values for each variable in tips:

```{r}
summary(tips)
```


What is the relationship between total bill and tip value?
First, we need to install and load `ggplot2` (a graphics library):

```{r, eval=FALSE}
install.packages("ggplot2")
library(ggplot2)
```

```{r, echo=FALSE, message = F, warning = F}
library(ggplot2)
```

```{r, fig.height = 3, fig.width = 6}
qplot(x = tip, y = total_bill, geom = "point", data = tips)
```

We can add linear regression line to the plot:

```{r, fig.height = 4, fig.width = 6}
qplot(x = tip, y = total_bill, geom = "point", data = tips) + 
    geom_smooth(method = "lm")
```

Tipping is generally done using a rule of thumb based on a percentage of the total bill. We will make a new variable in the data set for the tipping rate = tip / total bill

```{r}
tips$rate <- tips$tip / tips$total_bill

summary(tips$rate)
```

What is the distribution of tip rate in this dataset? We can use R to create a histogram:

```{r, fig.height = 4, fig.width = 6}
qplot(x = rate, data = tips, binwidth = .01)
```

One person tipped over 70%, who are they?

```{r}
tips[which.max(tips$rate),]
```

We can also calculate the average tipping rate for men and women separately:

```{r}
mean(tips$rate[tips$sex == "Male"])
mean(tips$rate[tips$sex == "Female"])
```

Is the difference between the two groups statistically significant? We can calculate a t-test to examine whether the average tip rate for men is the same as the average tip rate for women. 

```{r}
t.test(rate ~ sex, data = tips)
```

The p-value is greater than 0.05, and the confidence interval contains 0: there is no evidence of a significant difference in tipping rate between men and women. 

We can compare two groups using a side-by-side boxplot. For instance, we can see whether smokers tip at a different rate than non-smokers: 

```{r, fig.height = 3, fig.width = 6}
qplot(x = smoker, y = rate, geom = "boxplot", data = tips)
```

## Your Turn!

Try playing with chunks of code shown above to further investigate the tips data:

1. Get a summary of the total bill values
2. Make side by side boxplots of tip rates for different days of the week
3. Find the average tip value for smokers

### Solutions

1. Get a summary of the total bill values
```{r}
summary(tips$total_bill)
```

2. Make side by side boxplots of tip rates for different days of the week
```{r}
qplot(day, rate, geom = "boxplot", data = tips)
```

3. Find the average tip value for smokers
```{r}
mean(tips$tip[tips$smoker == "Yes"])
