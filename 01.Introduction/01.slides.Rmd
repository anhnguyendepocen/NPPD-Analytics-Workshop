---
title: "Introduction to R"
output: 
    revealjs::revealjs_presentation:
        transition: fade
        theme: white
        highlight: zenburn
        css: ../css/slides.css
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = T, comments = T, collapse = T)
```

# Setting up R for Data Analysis

## Your Background

What do you know already?

> - Excel
> - SAS, SPSS, Minitab
> - Any other programming language
> - SQL or other database

## Installing R

For Windows or OS X:

- Go to http://www.r-project.org/
- Click the CRAN link on the left, and pick a download site (0-Cloud is a good choice)
- Choose link based on your OS
- On Windows, choose the "base" subdirectory to install R.
- On OS X, choose the .pkg file to install R.

## Installing RStudio

- Browse to https://www.rstudio.com/
- Mouse over Products and click RStudio
- Choose RStudio Desktop
- Click Download RStudio Desktop
- Choose the installer appropriate for your platform

# Example: Tips Data

## Goals

- Explore a real dataset using R
- Get the "flavor" of R for data management and exploration
- Don't focus on the code - it will be explained later and in much more detail

## Tips Dataset

A server recorded the tips they received over about 10 weeks, including several variables:

  - Amount they were tipped
  - Cost of the total bill
  - Characteristics about the party (# people, gender, etc.)

## Primary Question:

How do these variable influence the amount being tipped?

Follow along using [Tips-Example.R](code/Tips-Example.R)

## First Look at Data in R

Load the tips data using `read.csv()`

```{r, echo = T}
tips <- read.csv("http://srvanderplas.github.com/NPPD-Analytics-Workshop/01.Introduction/data/tips.csv")
# Short link:
tips <- read.csv("http://bit.ly/2fQoMP1")
```

The `head()` function shows the first few rows of the data: 
```{r, echo = T}
head(tips)
```

## Data Set Attributes

How big is the dataset? What types of variables are in each column?
```{r}
str(tips)
```

## Summary of Variables

R can easily summarize each variable in the dataset: 
```{r}
summary(tips)
```

## Plotting the data

First, we need to install and load `ggplot2`, a library for plotting the data
```{r, eval=FALSE}
install.packages("ggplot2")
library(ggplot2)
```

```{r, echo=FALSE}
library(ggplot2)
```

## Scatterplots

What is the relationship between total bill and tip value? 

```{r, fig.height=3, fig.width=7}
qplot(tip, total_bill, geom = "point", data = tips)
```

## Fancy Scatterplots

Color the points by meal. Is there a difference?

```{r, fig.height=4, fig.width=7}
qplot(tip, total_bill, geom = "point", data = tips, colour = time)
```

## Even More Scatterplots

Add a linear regression line to the plot

```{r, fig.height=4, fig.width=7}
qplot(tip, total_bill, geom = "point", data = tips) + 
    geom_smooth(method = "lm")
```


## Rate of Tipping

Tips are usually based on a percentage of the total bill. 

Make a new variable for the tipping rate = tip / total bill

```{r}
# New variable rate is a combination of 
# other variables in the tips dataset
tips$rate <- tips$tip / tips$total_bill

summary(tips$rate)
```

## Tipping Rate Histogram

What is the distribution of tipping rates? 

```{r, fig.height=4, fig.width=7}
qplot(rate, data = tips, binwidth = .01)
```

## Someone is an AMAZING tipper...

One person tipped over 70%, who are they?

```{r}
tips[which.max(tips$rate),]
```


## Rates by Gender

Look at the average tipping rate for men and women seperately

```{r}
mean(tips$rate[tips$sex == "Male"])
mean(tips$rate[tips$sex == "Female"])
```

## Statistical Significance

There is a difference but is it statistically significant?

```{r}
t.test(rate ~ sex, data = tips)
```

## Boxplots

Boxplots are useful for comparing the distribution of data. Do smokers tip at different rates than non-smokers?

```{r, fig.height=3, fig.width=7}
qplot(smoker, rate, geom = "boxplot", data = tips)
```

## Your Turn {data-background=#527a7a}

Try playing with chunks of code from this session to further investigate the tips data:

1. Get a summary of the total bill values
2. Make side by side boxplots of tip rates for different days of the week
3. Find the average tip value for smokers

## Your Turn Solutions
### Summary  of Total Bill Values
```{r}
summary(tips$total_bill)
```

## Your Turn Solutions
### Tip Values by Day of the Week

```{r, fig.height=3, fig.width=7}
qplot(day, rate, geom = "boxplot", data = tips)
```

## Your Turn Solutions
### Average Tip Value for Smokers
```{r}
mean(tips$tip[tips$smoker == "Yes"])
```



# R Basics

## Getting Help in R
The `help()` function is useful for getting help with a function:

```{r, eval = F}
help(head)
```

The `?` function also works:

```{r, eval = F}
?head
```

When searching for results online, it is helpful to use R + CRAN + <query> to get good results.

## R Reference Card

A copy of the R reference card is available at: 

http://cran.r-project.org/doc/contrib/Short-refcard.pdf

This card contains short versions of the most common functions used in R.

## R as an Overgrown Calculator

R can perform simple mathematical operations.
```{r}
# Addition and Subtraction
2 + 5 - 1

# Multiplication
109*23452

# Division
3/7
```

## R as an Overgrown Calculator

Here are a few more complex operations:
```{r}
# Integer division
7 %/% 2

# Modulo operator (Remainder)
7 %% 2

# Powers
1.5 ^ 3
```

## R as an Overgrown Calculator

```{r}
# Exponentiation
exp(3)

# Logarithms
log(3)
log(3, base = 10)
```

## R as an Overgrown Calculator

```{r}
# Trig functions
sin(0)
cos(0)
tan(pi/4)
```

## Variables in R

Variables in R are created using the assignment operator, `<-`:

```{r}
x <- 5
R_awesomeness <- Inf
MyAge <- 21 #Haha
```

These variables can then be used in computation:
```{r}
log(x)
MyAge ^ 2
```

## Rules for Variable Names

- Can't start with a number
- Names are case-sensitive
- Common letters are used internally by R and should be avoided as variable names    
`c, q, t, C, D, F, T, I`
- There are reserved words that R won't let you use for variable names.    
`for, in, while, if, else, repeat, break, next`
- R will let you use the name of a predefined function.    
Try not to overwrite those!

## Rules for Variable Names
Error messages:
```{r, error = T, collapse = F}
# Variable starts with a number
1age <- 3
```

## Rules for Variable Names
Error messages:
```{r, error = T, collapse = F}
# Case Sensitive
Age <- 3
age
```

## Rules for Variable Names
Error messages:
```{r, error = T, collapse = F}
# Special Words can't be variable names
for <- 3
```

## Rules for Variable Names

```{r, collapse = T}
# This is a VERY bad idea:

T <- FALSE
F <- TRUE

T == FALSE
F == TRUE

rm(T, F) # Fix it!

T == FALSE
```
Note: In R, `T` and `F` are shorthand for `TRUE` and `FALSE` respectively. 

## Vectors
A variable can contain more than one value.    
A _vector_ is a variable which contains a set of values of the same type.    
The `c()` (combine) function is used to create vectors:

```{r}
y <- c(1, 5, 3, 2)
z <- c(y, y)
```

R performs operations on the entire vector at once:
```{r}
y / 2
z + 3
```


## Your Turn {data-background=#527a7a}

Using the R Reference Card (and the Help pages, if needed), do the following:

1. Find out how many rows and columns the `iris' data set has.  Figure out at least 2 ways to do this.    
*Hint: "Variable Information" section on the first page of the reference card!*
2. Use the `rep` function to construct the following vector:  `1 1 2 2 3 3 4 4 5 5`    
*Hint: "Data Creation" section of the reference card*
3. Use `rep` to construct this vector: `1 2 3 4 5 1 2 3 4 5 1 2 3 4 5`

## Your Turn Solutions{data-background=#527a7a}

1. Find out how many rows and columns the `iris' data set has.  Figure out at least 2 ways to do this.

```{r}
data(iris)

# first way: 
nrow(iris)
ncol(iris)
```

## Your Turn Solutions{data-background=#527a7a}

1. Find out how many rows and columns the `iris' data set has.  Figure out at least 2 ways to do this.
```{r}
# second way: 
dim(iris)

# third way: 
str(iris) # look at the top line
```

## Your Turn Solutions{data-background=#527a7a}

2. Use the `rep` function to construct the following vector:  1 1 2 2 3 3 4 4 5 5
```{r}
rep(c(1:5), each = 2)
```

3. Use `rep` to construct this vector: 1 2 3 4 5 1 2 3 4 5 1 2 3 4 5
```{r}
rep(c(1:5), times = 3)
```
